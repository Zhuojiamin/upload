<!--<?php
print <<<EOT
-->
<script language="javascript">
var defaultmode = "divmode";
var text = "";
var head = document.getElementsByTagName("head")[0];
var script = document.createElement("script");
script.src = 'js/lang/zh_cn.js';
head.appendChild(script);

if (defaultmode == "nomode") {
        helpmode = false;
        divmode = false;
        nomode = true;
} else if (defaultmode == "helpmode") {
        helpmode = true;
        divmode = false;
        nomode = false;
} else {
        helpmode = false;
        divmode = true;
        nomode = false;
}
function checkmode(swtch){
	if (swtch == 1){
		nomode = false;
		divmode = false;
		helpmode = true;
		alert(I18N['wind_help_1']);
	} else if (swtch == 0) {
		helpmode = false;
		divmode = false;
		nomode = true;
		alert(I18N['wind_help_2']);
	} else if (swtch == 2) {
		helpmode = false;
		nomode = false;
		divmode = true;
		alert(I18N['wind_help_3']);
	}
}
function getActiveText(selectedtext) {
  text = (document.all) ? document.selection.createRange().text : document.getSelection();
  if (selectedtext.createTextRange) {	
    selectedtext.caretPos = document.selection.createRange().duplicate();	
  }
	return true;
}
function submitonce(theform)
{
	if (document.all||document.getElementById)
	{
		for (i=0;i<theform.length;i++)
		{
			var tempobj=theform.elements[i];
			if(tempobj.type.toLowerCase()=="submit"||tempobj.type.toLowerCase()=="reset")
				tempobj.disabled=true;
		}
	}
}
function checklength(theform)
{
	alert(I18N['currentbits'] + theform.atc_content.value.length);
}
function AddText(NewCode) 
{
	if (document.FORM.atc_content.createTextRange && document.FORM.atc_content.caretPos) 
	{
		var caretPos = document.FORM.atc_content.caretPos;
		caretPos.text = caretPos.text.charAt(caretPos.text.length - 1) == ' ' ? NewCode + ' ' : NewCode;
	} 
	else 
	{
		document.FORM.atc_content.value+=NewCode
	}
	setfocus();
}
function setfocus()
{
  document.FORM.atc_content.focus();
}


function showsize(size) {
	if (helpmode) {
		alert(I18N['fontsize'] + "[size=" + size + "] " + size + I18N['word'] + "[/size]");
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[size="+size+"]"+text+"[/size]";
		AddText(AddTxt);
	} else {
		txt=prompt('',I18N['word']);
		if (txt!=null) {
			AddTxt="[size="+size+"]"+txt;
			AddText(AddTxt);
			AddTxt="[/size]";
			AddText(AddTxt);
		}
	}
}

function showfont(font) {
 	if (helpmode){
		alert(I18N['setfont']+" [font="+font+"]"+font+"[/font]");
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[font="+font+"]"+text+"[/font]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['fontword']+font,I18N['word']);
		if (txt!=null) {
			AddTxt="[font="+font+"]"+txt;
			AddText(AddTxt);
			AddTxt="[/font]";
			AddText(AddTxt);
		}
	}
}
function showcolor(color) {
	if (helpmode) {
		alert(I18N['setcolor']+"[color="+color+"]"+color+"[/color]");
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[color="+color+"]"+text+"[/color]";
		AddText(AddTxt);
	} else {  
     	txt=prompt(I18N['color']+color,I18N['word']);
		if(txt!=null) {
			AddTxt="[color="+color+"]"+txt;
			AddText(AddTxt);
			AddTxt="[/color]";
			AddText(AddTxt);
		}
	}
}

function bold() {
	if (helpmode) {
		alert(I18N['setbold']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[b]"+text+"[/b]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['blogword'],I18N['word']);
		if (txt!=null) {
			AddTxt="[b]"+txt;
			AddText(AddTxt);
			AddTxt="[/b]";
			AddText(AddTxt);
		}
	}
}

function italicize() {
	if (helpmode) {
		alert(I18N['setitalic']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[i]"+text+"[/i]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['italicword'],I18N['word']);
		if (txt!=null) {
			AddTxt="[i]"+txt;
			AddText(AddTxt);
			AddTxt="[/i]";
			AddText(AddTxt);
		}
	}
}

function quoteme() {
	if (helpmode){
		alert(I18N['quote']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[quote]"+text+"[/quote]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['quoteword'],I18N['word']);
		if(txt!=null) {
			AddTxt="[quote]"+txt;
			AddText(AddTxt);
			AddTxt="[/quote]";
			AddText(AddTxt);
		}
	}
}
function setfly() {
 	if (helpmode){
		alert(I18N['setfly']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[fly]"+text+"[/fly]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['flyword'],I18N['word']);
		if (txt!=null) {
			AddTxt="[fly]"+txt;
			AddText(AddTxt);
			AddTxt="[/fly]";
			AddText(AddTxt);
		}
	}
}

function movesign() {
	if (helpmode) {
		alert(I18N['setmove']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[move]"+text+"[/move]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['moveword'],I18N['word']);
		if (txt!=null) {
			AddTxt="[move]"+txt;
			AddText(AddTxt);
			AddTxt="[/move]";
			AddText(AddTxt);
		}
	}
}

function shadow() {
	if (helpmode) {
		alert(I18N['setshadow']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[SHADOW=255,blue,1]"+text+"[/SHADOW]";
		AddText(AddTxt);
	} else {
		txt2=prompt(I18N['shadowsize'],"255,blue,1");
		if (txt2!=null) {
			txt=prompt(I18N['shadowword'],I18N['word']);
			if (txt!=null) {
				if (txt2=="") {
					AddTxt="[shadow=255, blue, 1]"+txt;
					AddText(AddTxt);
					AddTxt="[/shadow]";
					AddText(AddTxt);
				} else {
					AddTxt="[shadow="+txt2+"]"+txt;
					AddText(AddTxt);
					AddTxt="[/shadow]";
					AddText(AddTxt);
				}
			}
		}
	}
}

function glow() {
	if (helpmode) {
		alert(I18N['setglow']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[glow=255,red,2]"+text+"[/glow]";
		AddText(AddTxt);
	} else {
		txt2=prompt(I18N['glowsize'],"255,red,2");
		if (txt2!=null) {
			txt=prompt(I18N['glowword'],I18N['word']);
			if (txt!=null) {
				if (txt2=="") {
					AddTxt="[glow=255,red,2]"+txt;
					AddText(AddTxt);
					AddTxt="[/glow]";
					AddText(AddTxt);
				} else {
					AddTxt="[glow="+txt2+"]"+txt;
					AddText(AddTxt);
					AddTxt="[/glow]";
					AddText(AddTxt);
				}
			}
		}
	}
}

function center() {
 	if (helpmode) {
		alert(I18N['align']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[align=center]"+text+"[/align]";
		AddText(AddTxt);
	} else {
		txt2=prompt(I18N['alignway'],"center");
		while ((txt2!="") && (txt2!="center") && (txt2!="left") && (txt2!="right") && (txt2!=null)) {
			txt2=prompt(I18N['alignerror'],"");
		}
		txt=prompt(I18N['aligntext'],I18N['word']);
		if (txt!=null) {
			AddTxt="[align="+txt2+"]"+txt;
			AddText(AddTxt);
			AddTxt="[/align]";
			AddText(AddTxt);
		}
	}
}
/*
function rming() {
	if (helpmode) {
		alert(I18N['setrm']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[rm]"+text+"[/rm]";
		AddText(AddTxt);
	} else {
		txt=prompt('URL:',"http://");
		if(txt!=null) {
			AddTxt="[rm]"+txt;
			AddText(AddTxt);
			AddTxt="[/rm]";
			AddText(AddTxt);
		}
	}
}*/
function rming() {
	if (helpmode){
		alert(I18N['setrm']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[rm=316,241,1]"+text+"[/rm]";
		AddText(AddTxt);
	} else {
        txt2=prompt(I18N['wha'],"316,241,1");
		if (txt2!=null) {
			txt=prompt('URL:',"http://");
			if (txt!=null) {
				if (txt2=="") {
					AddTxt="[rm]"+txt;
					AddText(AddTxt);
					AddTxt="[/rm]";
					AddText(AddTxt);
				} else {
					AddTxt="[rm="+txt2+"]"+txt;
					AddText(AddTxt);
					AddTxt="[/rm]";
					AddText(AddTxt);
				}
			}
		}
	}
}

function image() {
	if (helpmode){
		alert(I18N['setimg']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[img]"+text+"[/img]";
		AddText(AddTxt);
	} else {
		txt=prompt('URL:',"http://");
		if(txt!=null) {
			AddTxt="[img]"+txt;
			AddText(AddTxt);
			AddTxt="[/img]";
			AddText(AddTxt);
		}
	}
}
/*
function wmv() {
	if (helpmode){
		alert(I18N['setwmv']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[wmv]"+text+"[/wmv]";
		AddText(AddTxt);
	} else {
		txt=prompt('URL:',"http://");
		if(txt!=null) {
			AddTxt="[wmv]"+txt;
			AddText(AddTxt);
			AddTxt="[/wmv]";
			AddText(AddTxt);
		}
	}
}*/
function wmv() {
	if (helpmode){
	    alert(I18N['setwmv']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
	    AddTxt="[wmv=314,256,1]"+text+"[/wmv]";
	    AddText(AddTxt);
	} else {
	    txt2=prompt(I18N['wha'],"314,256,1");
	    if (txt2!=null) {
		    txt=prompt('URL:',"http://");
		    if (txt!=null) {
			    if (txt2=="") {
				    AddTxt="[wmv]"+txt;
				    AddText(AddTxt);
				    AddTxt="[/wmv]";
				    AddText(AddTxt);
			    } else {
				    AddTxt="[wmv="+txt2+"]"+txt;
				    AddText(AddTxt);
				    AddTxt="[/wmv]";
				    AddText(AddTxt);
			    }
		    }
	    }
	}
}


function showurl() {
 	if (helpmode){
		alert(I18N['seturl']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[url="+text+"]"+text+"[/url]";
		AddText(AddTxt);
	} else {
			txt2=prompt(I18N['urlname'],"");
		if (txt2!=null) {
			txt=prompt('URL:',"http://");
			if (txt2!=null) {
				if (txt2=="") {
					AddTxt="[url]"+txt;
					AddText(AddTxt);
					AddTxt="[/url]";
					AddText(AddTxt);
				} else {
					if(txt==""){
						AddTxt="[url]"+txt2;
						AddText(AddTxt);
						AddTxt="[/url]";
						AddText(AddTxt);
					} else{
						AddTxt="[url="+txt+"]"+txt2;
						AddText(AddTxt);
						AddTxt="[/url]";
						AddText(AddTxt);
					}
				}
			}
		}
	}
}

function showcode() {
	if (helpmode) {
		alert(I18N['setcode']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[code]"+text+"[/code]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['codeword'],"");
		if (txt!=null) { 
			AddTxt="[code]"+txt;
			AddText(AddTxt);
			AddTxt="[/code]";
			AddText(AddTxt);
		}
	}
}

function list() {
	if (helpmode) {
		alert(I18N['setlist']);
	} else if (nomode) {
		AddTxt="[list][li][/li][li][/li][/list]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['listtype'],"");
		while ((txt!="") && (txt!="A") && (txt!="a") && (txt!="1") && (txt!=null)) {
			txt=prompt(I18N['listerror'],"");
		}
		if (txt!=null) {
			if (txt==""){
				AddTxt="[list]";
			} else if (txt=="1") {
				AddTxt="[list=1]";
			} else if(txt=="a") {
				AddTxt="[list=a]";
			}
			ltxt="1";
			while ((ltxt!="") && (ltxt!=null)) {
				ltxt=prompt(I18N['listitem'],"");
				if (ltxt!="") {
					AddTxt+="[li]"+ltxt+"[/li]";
				}
			}
			AddTxt+="[/list]";
			AddText(AddTxt);
		}
	}
}
function underline() {
  	if (helpmode) {
		alert(I18N['underline']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[u]"+text+"[/u]";
		AddText(AddTxt);
	} else {
		txt=prompt(I18N['underlineword'],I18N['word']);
		if (txt!=null) {
			AddTxt="[u]"+txt;
			AddText(AddTxt);
			AddTxt="[/u]";
			AddText(AddTxt);
		}
	}
}

function setswf() {
 	if (helpmode){
		alert(I18N['setflash']);
	} else if (nomode || document.selection && document.selection.type == "Text") {
		AddTxt="[flash=400,300]"+text+"[/flash]";
		AddText(AddTxt);
	} else {
			txt2=prompt(I18N['flashsize'],"400,300");
		if (txt2!=null) {
			txt=prompt('URL:',"http://");
			if (txt!=null) {
				if (txt2=="") {
					AddTxt="[flash=400,300]"+txt;
					AddText(AddTxt);
					AddTxt="[/flash]";
					AddText(AddTxt);
				} else {
					AddTxt="[flash="+txt2+"]"+txt;
					AddText(AddTxt);
					AddTxt="[/flash]";
					AddText(AddTxt);
				}
			}
		}
	}
}

function add_title(addTitle)
{ 
	var revisedTitle; 
	var currentTitle = document.FORM.atc_title.value; 
	revisedTitle =addTitle+ currentTitle; 
	document.FORM.atc_title.value=revisedTitle; 
	document.FORM.atc_title.focus(); 
	return;
}

function copytext(theField){
	var tempval=eval("document."+theField);
	tempval.focus();
	tempval.select();
	therange=tempval.createTextRange();
	therange.execCommand("Copy");
}

function replac(){
	if (helpmode)
	{
		alert(I18N['setsearch']);
	}
	else
	{
		txt2=prompt(I18N['search'],"");
		if (txt2 != null)
		{
			if (txt2 != "") 
			{
				txt=prompt(I18N['replace'],txt2);
			}
			else
			{
				replac();
			}
			var Rtext = txt2; var Itext = txt;
			Rtext = new RegExp(Rtext,"g");
			document.FORM.atc_content.value =document.FORM.atc_content.value.replace(Rtext,Itext);
		}
	}
}
function addattach(aid){
	AddTxt=' [attachment='+aid+'] ';
	AddText(AddTxt);
}
function addsmile(NewCode){
    document.FORM.atc_content.value += ' [s:'+NewCode+'] ';
}
cnt = 0;
function quickpost(event){
	if((event.ctrlKey && event.keyCode == 13)||(event.altKey && event.keyCode == 83)){
		 cnt++;
		 if(cnt==1){
			 this.document.FORM.submit();
		 }else{
			 alert('Submission Processing. Please Wait');
		 }
	}
}
function Dialog(url, action, init) {
	if (typeof init == "undefined") {
		init = window;
	}
	Dialog._geckoOpenModal(url, action, init);
};
Dialog._parentEvent = function(ev) {
	if (Dialog._modal && !Dialog._modal.closed) {
		Dialog._modal.focus();
		WYSIWYD._stopEvent(ev);
	}
};
Dialog._return = null;
Dialog._modal = null;
Dialog._arguments = null;

Dialog._geckoOpenModal = function(url, action, init) {
	var dlg = window.open(url, "hadialog",
			      "toolbar=no,menubar=no,personalbar=no,top=200,left=300,width=10,height=10," +
			      "scrollbars=no,resizable=yes");
	Dialog._modal = dlg;
	Dialog._arguments = init;
	Dialog._return = function (val) {
		if (val && action) {
			action(val);
		}
		Dialog._modal = null;
	};
};
function saletable(url) {
	Dialog(url, function(param) {
		AddText(param);
		return true;
	}, null);
}
function softtable(url){
	Dialog(url, function(param) {
		AddText(param);
		return true;
	}, null);
}
</script>
<div style="margin-bottom:10px">
字体 
<select onChange="showfont(this.options[this.selectedIndex].value);this.selectedIndex=0;this.selectedIndex=0" name="font">
<option value=""></option>
<option value="宋体">宋体</option>
<option value="楷体_GB2312">楷体_GB2312</option>
<option value="新宋体">新宋体</option>
<option value="黑体">黑体</option>
<option value="隶书">隶书</option>
<option value="Andale Mono">Andale Mono</option>
<option value="Arial">Arial</option>
<option value="Arial Black">Arial Black</option>
<option value="Book Antiqua">Book Antiqua</option>
<option value="Century Gothic">Century Gothic</option>
<option value="Comic Sans MS">Comic Sans MS</option>
<option value="Courier New">Courier New</option>
<option value="Georgia">Georgia</option>
<option value="Impact">Impact</option>
<option value="Tahoma">Tahoma</option>
<option value="Times New Roman">Times New Roman</option>
<option value="Trebuchet MS">Trebuchet MS</option>
<option value="Script MT Bold">Script MT Bold</option>
<option value="Stencil">Stencil</option>
<option value="Verdana">Verdana</option>
<option value="Lucida Console">Lucida Console</option></select>
&nbsp;字号
<select onChange="showsize(this.options[this.selectedIndex].value);this.selectedIndex=0" name="size">
<option value=""></option>
<option value="1">1</option><option value="2">2</option><option value="3">3</option>
<option value="4">4</option><option value="5">5</option><option value="6">6</option>
</select>
&nbsp;字体颜色 
<select onChange="showcolor(this.options[this.selectedIndex].value);this.selectedIndex=0" name="color">
<option value=""></option>
<option value="skyblue" style="background-color:skyblue;color:skyblue">&nbsp; &nbsp; &nbsp;  &nbsp;</option>
<option value="royalblue" style="background-color:royalblue;color:royalblue"></option>
<option value="blue" style="background-color:blue"></option>
<option value="darkblue" style="background-color:darkblue"></option>
<option value="orange" style="background-color:orange"></option>
<option value="orangered" style="background-color:orangered"></option>
<option value="crimson" style="background-color:crimson"></option>
<option value="red" style="background-color:red"></option>
<option value="firebrick" style="background-color:firebrick"></option>
<option value="darkred" style="background-color:darkred"></option>
<option value="green" style="background-color:green"></option>
<option value="limegreen" style="background-color:limegreen"></option>
<option value="seagreen" style="background-color:seagreen"></option>
<option value="teal" style="background-color:teal"></option>
<option value="deeppink" style="background-color:deeppink"></option>
<option value="tomato" style="background-color:tomato"></option>
<option value="coral" style="background-color:coral"></option>
<option value="purple" style="background-color:purple"></option>
<option value="indigo" style="background-color:indigo"></option>
<option value="burlywood" style="background-color:burlywood"></option>
<option value="sandybrown" style="background-color:sandybrown"></option>
<option value="sienna" style="background-color:sienna"></option>
<option value="chocolate" style="background-color:chocolate"></option>
<option value="silver" style="background-color:silver"></option></select>
<br /><br />
<img onClick="bold()" alt="粗体" src="$imgpath/editor/bold.gif" />
<img onClick="italicize()" alt="斜体" src="$imgpath/editor/italic.gif" />
<img onClick="underline()" alt="下划线" src="$imgpath/editor/underline.gif" />
<img onClick="center()" alt="居中" src="$imgpath/editor/center.gif"  />
<img onClick="rming()" alt="插入rm电影文件" src="$imgpath/editor/rm.gif" />
<img onClick="wmv()" alt="插入wmv在线播放" src="$imgpath/editor/mpeg.gif" />
<img onClick="image()" alt="插入图片" src="$imgpath/editor/image.gif" />
<img onClick="setswf()" alt="插入flash动画" src="$imgpath/editor/swf.gif" />
<img onClick="showurl()" alt="插入url链接" src="$imgpath/editor/url.gif" />
<img onClick="showcode()" alt="插入代码" src="$imgpath/editor/code.gif" />
<img onClick="quoteme()" alt="插入引用" src="$imgpath/editor/quote.gif" />
<img onClick="list()" alt="插入列表" src="$imgpath/editor/list_2.gif" />
<img onClick="setfly()" alt="飞行字" src="$imgpath/editor/fly.gif" />
<img onClick="movesign()" alt="移动字" src="$imgpath/editor/move.gif" />
<img onClick="glow()" alt="发光字" src="$imgpath/editor/glow.gif" />
</div>
<textarea name="atc_content" id="atc_content" cols="90" rows="15" style="overflow:auto;"  onkeydown="quickpost(event)" onfocus="getActiveText(this)" onclick="getActiveText(this)"  onchange="getActiveText(this)" tabindex="2">{$atc_content}</textarea>
<!--
EOT;
?>